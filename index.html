<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Company Data Extractor (Address Splitter)</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@300;400;600&display=swap" rel="stylesheet">
    <style> body { font-family: 'Sarabun', sans-serif; } </style>
</head>
<body class="bg-gray-100 p-6">

    <div class="max-w-5xl mx-auto bg-white shadow-xl rounded-xl overflow-hidden">
        <div class="bg-indigo-700 p-6 text-white shadow-inner">
            <h1 class="text-2xl font-bold">‡∏£‡∏∞‡∏ö‡∏ö‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó (‡πÅ‡∏ö‡∏ö‡πÅ‡∏¢‡∏Å‡∏ä‡πà‡∏≠‡∏á‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà)</h1>
            <p class="text-sm opacity-90">‡πÅ‡∏¢‡∏Å ‡∏ñ‡∏ô‡∏ô / ‡πÅ‡∏Ç‡∏ß‡∏á / ‡πÄ‡∏Ç‡∏ï / ‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î ‡πÉ‡∏´‡πâ‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥</p>
        </div>

        <div class="p-6 grid grid-cols-1 lg:grid-cols-2 gap-8">
            
            <div class="space-y-4">
                <div class="bg-yellow-50 p-4 rounded-lg border-2 border-yellow-300 shadow-sm">
                    <label class="block text-gray-800 text-sm font-bold mb-2">1. ‡∏ß‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏î‡∏¥‡∏ö‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà (Paste Raw Data):</label>
                    <textarea id="rawInput" rows="15" class="w-full p-3 border border-yellow-300 rounded bg-yellow-100 focus:outline-none focus:ring-2 focus:ring-yellow-500 text-sm leading-relaxed" placeholder="‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á:
Ritta Co., Ltd. ‡∏ä‡∏∑‡πà‡∏≠‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó
300 Romklao Road ‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà
Latkrabang ‡∏≠‡∏≥‡πÄ‡∏†‡∏≠‡πÄ‡∏°‡∏∑‡∏≠‡∏á
Bangkok ‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î
10520 ‡∏£‡∏´‡∏±‡∏™‡πÑ‡∏õ‡∏£‡∏©‡∏ì‡∏µ‡∏¢‡πå..."></textarea>
                    
                    <div class="flex gap-2 mt-3">
                        <button onclick="processData()" class="flex-1 bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-2 px-4 rounded transition shadow">
                            ‚ö° ‡πÅ‡∏¢‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• (Extract)
                        </button>
                        <button onclick="clearAll()" class="w-24 bg-gray-200 hover:bg-gray-300 text-gray-700 font-bold py-2 px-4 rounded transition">
                            ‡∏•‡πâ‡∏≤‡∏á
                        </button>
                    </div>
                </div>
            </div>

            <div class="space-y-4">
                <div class="bg-green-50 p-6 rounded-lg border-2 border-green-300 shadow-sm space-y-3">
                    <h2 class="text-gray-800 font-bold border-b border-green-200 pb-2 mb-4">2. ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• (Verified Data)</h2>

                    <div>
                        <label class="text-xs font-bold text-indigo-700 uppercase">Company Name</label>
                        <input type="text" id="companyName" class="w-full p-2 border border-green-300 rounded bg-white font-semibold text-gray-800 focus:ring-2 focus:ring-green-400">
                    </div>

                    <div class="bg-green-100 p-3 rounded border border-green-200 space-y-2">
                        <p class="text-xs font-bold text-gray-500 mb-1">--- ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà (Address Details) ---</p>
                        
                        <div>
                            <label class="text-[10px] text-gray-500">‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà / ‡∏≠‡∏≤‡∏Ñ‡∏≤‡∏£ / ‡∏ñ‡∏ô‡∏ô (Address/Street)</label>
                            <input type="text" id="addr_street" class="w-full p-1.5 border border-green-300 rounded bg-white text-sm">
                        </div>

                        <div class="grid grid-cols-2 gap-2">
                            <div>
                                <label class="text-[10px] text-gray-500">‡πÅ‡∏Ç‡∏ß‡∏á / ‡∏ï‡∏≥‡∏ö‡∏• (Sub-district)</label>
                                <input type="text" id="addr_subdistrict" class="w-full p-1.5 border border-green-300 rounded bg-white text-sm">
                            </div>
                            <div>
                                <label class="text-[10px] text-gray-500">‡πÄ‡∏Ç‡∏ï / ‡∏≠‡∏≥‡πÄ‡∏†‡∏≠ (District)</label>
                                <input type="text" id="addr_district" class="w-full p-1.5 border border-green-300 rounded bg-white text-sm">
                            </div>
                        </div>

                        <div class="grid grid-cols-2 gap-2">
                            <div>
                                <label class="text-[10px] text-gray-500">‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î (Province)</label>
                                <input type="text" id="addr_province" class="w-full p-1.5 border border-green-300 rounded bg-white text-sm">
                            </div>
                            <div>
                                <label class="text-[10px] text-gray-500">‡∏£‡∏´‡∏±‡∏™‡πÑ‡∏õ‡∏£‡∏©‡∏ì‡∏µ‡∏¢‡πå (Zip Code)</label>
                                <input type="text" id="addr_zip" class="w-full p-1.5 border border-green-300 rounded bg-white text-sm text-center font-bold tracking-widest text-indigo-800">
                            </div>
                        </div>
                    </div>

                    <div class="grid grid-cols-2 gap-3 pt-2">
                        <div>
                            <label class="text-xs font-bold text-gray-500">Tax ID</label>
                            <input type="text" id="taxId" class="w-full p-2 border border-green-300 rounded bg-white text-sm">
                        </div>
                        <div>
                            <label class="text-xs font-bold text-gray-500">Phone</label>
                            <input type="text" id="phone" class="w-full p-2 border border-green-300 rounded bg-white text-sm">
                        </div>
                    </div>
                    <div>
                        <label class="text-xs font-bold text-gray-500">Email</label>
                        <input type="text" id="email" class="w-full p-2 border border-green-300 rounded bg-white text-sm">
                    </div>

                    <hr class="border-green-300 my-2">
                    
                    <button onclick="saveToSheet()" id="btnSave" class="w-full bg-green-600 hover:bg-green-700 text-white font-bold py-3 px-4 rounded shadow-lg flex justify-center items-center gap-2 transition transform active:scale-95">
                        <span>üíæ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• (Save)</span>
                    </button>
                    <p id="statusMsg" class="text-center text-xs mt-2 h-4 font-semibold"></p>
                </div>
            </div>
        </div>
    </div>

    <script>
        // *** ‡∏ß‡∏≤‡∏á URL Google Apps Script ‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà ***
        const GOOGLE_SCRIPT_URL = '‡∏ß‡∏≤‡∏á_URL_‡∏à‡∏≤‡∏Å_GOOGLE_APPS_SCRIPT_‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà';

        function clearAll() {
            document.getElementById('rawInput').value = '';
            ['companyName', 'addr_street', 'addr_subdistrict', 'addr_district', 'addr_province', 'addr_zip', 'taxId', 'phone', 'email'].forEach(id => document.getElementById(id).value = '');
            document.getElementById('statusMsg').innerText = '';
        }

        function cleanSuffix(text) {
            // ‡∏•‡∏ö‡∏Ñ‡∏≥‡∏ï‡πà‡∏≠‡∏ó‡πâ‡∏≤‡∏¢‡∏†‡∏≤‡∏©‡∏≤‡πÑ‡∏ó‡∏¢‡∏ó‡∏µ‡πà‡∏ï‡∏¥‡∏î‡∏°‡∏≤‡∏à‡∏≤‡∏Å PDF
            return text.replace(/(‡∏ä‡∏∑‡πà‡∏≠‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó|‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà|‡∏≠‡∏≥‡πÄ‡∏†‡∏≠‡πÄ‡∏°‡∏∑‡∏≠‡∏á|‡∏≠‡∏≥‡πÄ‡∏†‡∏≠|‡πÄ‡∏Ç‡∏ï|‡πÅ‡∏Ç‡∏ß‡∏á|‡∏ï‡∏≥‡∏ö‡∏•|‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î|‡∏£‡∏´‡∏±‡∏™‡πÑ‡∏õ‡∏£‡∏©‡∏ì‡∏µ‡∏¢‡πå|‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå|‡∏≠‡∏µ‡πÄ‡∏°‡∏•‡∏•‡πå‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô|‡∏≠‡∏µ‡πÄ‡∏°‡∏•).*$/i, '').trim();
        }

        function processData() {
            const rawText = document.getElementById('rawInput').value;
            
            // ‡∏•‡πâ‡∏≤‡∏á‡∏Ñ‡πà‡∏≤‡πÄ‡∏Å‡πà‡∏≤
            ['companyName', 'addr_street', 'addr_subdistrict', 'addr_district', 'addr_province', 'addr_zip', 'taxId', 'phone', 'email'].forEach(id => document.getElementById(id).value = '');

            const lines = rawText.split('\n').map(l => l.trim()).filter(l => l !== '');

            lines.forEach(line => {
                const lowerLine = line.toLowerCase();
                const cleaned = cleanSuffix(line);

                // --- 1. ‡∏ä‡∏∑‡πà‡∏≠‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó ---
                // ‡πÄ‡∏ä‡πá‡∏Ñ‡∏à‡∏≤‡∏Å‡∏Ñ‡∏≥‡∏•‡∏á‡∏ó‡πâ‡∏≤‡∏¢ "‡∏ä‡∏∑‡πà‡∏≠‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó" ‡∏´‡∏£‡∏∑‡∏≠‡∏Ñ‡∏≥‡∏ß‡πà‡∏≤ Co., Ltd.
                if (line.match(/‡∏ä‡∏∑‡πà‡∏≠‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó$/) || (/(Co\.,|Ltd\.|Limited|Company|‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó)/i.test(line) && !lowerLine.includes('end customer'))) {
                    // ‡∏ñ‡πâ‡∏≤‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏ä‡∏∑‡πà‡∏≠‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó ‡πÉ‡∏´‡πâ‡πÉ‡∏™‡πà‡πÄ‡∏•‡∏¢
                    if (!document.getElementById('companyName').value) {
                        document.getElementById('companyName').value = cleaned.replace(/[\(\)]/g, '').trim();
                    }
                }

                // --- 2. ‡∏≠‡∏µ‡πÄ‡∏°‡∏• ---
                const emailMatch = line.match(/([a-zA-Z0-9._-]+@[a-zA-Z0-9._-]+\.[a-zA-Z0-9._-]+)/);
                if (emailMatch) document.getElementById('email').value = emailMatch[0];

                // --- 3. ‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£ ---
                const phoneMatch = line.match(/(0\d{1,2}[-\s]?\d{3,4}[-\s]?\d{3,4})/);
                if (phoneMatch) document.getElementById('phone').value = phoneMatch[0];

                // --- 4. Tax ID ---
                const taxMatch = line.match(/\b\d{13}\b/);
                if (taxMatch) document.getElementById('taxId').value = taxMatch[0];

                // --- 5. ‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà (‡πÅ‡∏¢‡∏Å‡∏ä‡πà‡∏≠‡∏á) ---
                
                // 5.1 ‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î (Province) -> ‡∏î‡∏π‡∏Ñ‡∏≥‡∏•‡∏á‡∏ó‡πâ‡∏≤‡∏¢ "‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î" ‡∏´‡∏£‡∏∑‡∏≠‡∏Ñ‡∏≥‡∏ß‡πà‡∏≤ Bangkok
                if (line.match(/‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î$/) || lowerLine.includes('bangkok') || lowerLine.includes('province')) {
                     // ‡∏ñ‡πâ‡∏≤‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î‡∏ô‡∏µ‡πâ‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà‡∏¢‡∏≤‡∏ß‡πÜ (‡∏Ñ‡∏∑‡∏≠‡πÄ‡∏õ‡πá‡∏ô‡πÅ‡∏Ñ‡πà‡∏ä‡∏∑‡πà‡∏≠‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î)
                     if (cleaned.length < 20) {
                        document.getElementById('addr_province').value = cleaned;
                        return; // ‡∏à‡∏ö
                     }
                }

                // 5.2 ‡∏£‡∏´‡∏±‡∏™‡πÑ‡∏õ‡∏£‡∏©‡∏ì‡∏µ‡∏¢‡πå (Zip) -> ‡∏î‡∏π‡∏Ñ‡∏≥‡∏•‡∏á‡∏ó‡πâ‡∏≤‡∏¢ "‡∏£‡∏´‡∏±‡∏™‡πÑ‡∏õ‡∏£‡∏©‡∏ì‡∏µ‡∏¢‡πå" ‡∏´‡∏£‡∏∑‡∏≠‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç 5 ‡∏´‡∏•‡∏±‡∏Å‡πÇ‡∏î‡∏î‡πÜ
                if (line.match(/‡∏£‡∏´‡∏±‡∏™‡πÑ‡∏õ‡∏£‡∏©‡∏ì‡∏µ‡∏¢‡πå$/) || /^\d{5}$/.test(cleaned)) {
                    const zipMatch = line.match(/\d{5}/);
                    if (zipMatch) document.getElementById('addr_zip').value = zipMatch[0];
                    return;
                }

                // 5.3 ‡πÄ‡∏Ç‡∏ï/‡∏≠‡∏≥‡πÄ‡∏†‡∏≠ (District) -> ‡∏î‡∏π‡∏Ñ‡∏≥‡∏•‡∏á‡∏ó‡πâ‡∏≤‡∏¢ "‡∏≠‡∏≥‡πÄ‡∏†‡∏≠‡πÄ‡∏°‡∏∑‡∏≠‡∏á", "‡∏≠‡∏≥‡πÄ‡∏†‡∏≠", "‡πÄ‡∏Ç‡∏ï"
                if (line.match(/(‡∏≠‡∏≥‡πÄ‡∏†‡∏≠‡πÄ‡∏°‡∏∑‡∏≠‡∏á|‡∏≠‡∏≥‡πÄ‡∏†‡∏≠|‡πÄ‡∏Ç‡∏ï)$/) || lowerLine.includes('district') || lowerLine.includes('khet')) {
                    // ‡∏£‡∏∞‡∏ß‡∏±‡∏á: ‡∏ö‡∏≤‡∏á‡∏ó‡∏µ "‡∏≠‡∏≥‡πÄ‡∏†‡∏≠‡πÄ‡∏°‡∏∑‡∏≠‡∏á" ‡πÉ‡∏ô PDF ‡∏°‡∏±‡∏ô‡∏ï‡πà‡∏≠‡∏ó‡πâ‡∏≤‡∏¢ Latkrabang (‡∏ã‡∏∂‡πà‡∏á‡πÄ‡∏õ‡πá‡∏ô‡πÄ‡∏Ç‡∏ï)
                    document.getElementById('addr_district').value = cleaned;
                    return;
                }

                // 5.4 ‡πÅ‡∏Ç‡∏ß‡∏á/‡∏ï‡∏≥‡∏ö‡∏• (Sub-district) -> ‡∏î‡∏π‡∏Ñ‡∏≥‡∏ß‡πà‡∏≤ "‡πÅ‡∏Ç‡∏ß‡∏á", "‡∏ï‡∏≥‡∏ö‡∏•"
                if (line.match(/(‡πÅ‡∏Ç‡∏ß‡∏á|‡∏ï‡∏≥‡∏ö‡∏•)$/) || lowerLine.includes('sub-district') || lowerLine.includes('khwaeng') || lowerLine.includes('tambon')) {
                    document.getElementById('addr_subdistrict').value = cleaned;
                    return;
                }

                // 5.5 ‡∏ñ‡∏ô‡∏ô/‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà (Street/Address) -> ‡∏î‡∏π‡∏Ñ‡∏≥‡∏•‡∏á‡∏ó‡πâ‡∏≤‡∏¢ "‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà" ‡∏´‡∏£‡∏∑‡∏≠‡∏Ñ‡∏≥‡∏ß‡πà‡∏≤ Road
                if (line.match(/‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà$/) || lowerLine.includes('road') || lowerLine.includes('soi') || lowerLine.includes('moo')) {
                    document.getElementById('addr_street').value = cleaned;
                    return;
                }
            });
            
            // Fallback: ‡∏ñ‡πâ‡∏≤‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà ‡∏•‡∏≠‡∏á‡πÄ‡∏î‡∏≤‡∏à‡∏≤‡∏Å‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î‡∏ó‡∏µ‡πà‡πÄ‡∏´‡∏•‡∏∑‡∏≠
            // (‡∏™‡πà‡∏ß‡∏ô‡∏ô‡∏µ‡πâ‡∏≠‡∏≤‡∏à‡∏à‡∏∞‡∏ã‡∏±‡∏ö‡∏ã‡πâ‡∏≠‡∏ô‡πÄ‡∏Å‡∏¥‡∏ô‡πÑ‡∏õ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Regex ‡∏ò‡∏£‡∏£‡∏°‡∏î‡∏≤ ‡πÅ‡∏ï‡πà‡∏ó‡∏¥‡πâ‡∏á‡πÑ‡∏ß‡πâ‡πÉ‡∏´‡πâ‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏Å‡∏£‡∏≠‡∏Å‡πÄ‡∏≠‡∏á‡πÑ‡∏î‡πâ‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡πÄ‡∏à‡∏≠)
        }

        function saveToSheet() {
            if(GOOGLE_SCRIPT_URL.includes('‡∏ß‡∏≤‡∏á_URL') || GOOGLE_SCRIPT_URL === '') {
                alert('‚ö†Ô∏è ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÉ‡∏™‡πà URL Google Apps Script ‡∏Å‡πà‡∏≠‡∏ô‡∏Ñ‡∏£‡∏±‡∏ö');
                return;
            }

            const btn = document.getElementById('btnSave');
            const status = document.getElementById('statusMsg');
            
            // ‡∏£‡∏ß‡∏°‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà‡∏Å‡∏•‡∏±‡∏ö‡πÄ‡∏õ‡πá‡∏ô‡∏Å‡πâ‡∏≠‡∏ô‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏™‡πà‡∏á‡πÄ‡∏Ç‡πâ‡∏≤ Google Sheet (‡∏ï‡∏≤‡∏° Format ‡πÄ‡∏î‡∏¥‡∏°)
            // ‡∏´‡∏£‡∏∑‡∏≠‡∏Ñ‡∏∏‡∏ì‡∏à‡∏∞‡πÅ‡∏Å‡πâ Google Script ‡πÉ‡∏´‡πâ‡∏£‡∏±‡∏ö‡πÅ‡∏¢‡∏Å‡∏Å‡πá‡πÑ‡∏î‡πâ ‡πÅ‡∏ï‡πà‡∏ß‡∏¥‡∏ò‡∏µ‡∏ô‡∏µ‡πâ‡∏á‡πà‡∏≤‡∏¢‡∏™‡∏∏‡∏î‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡πÅ‡∏Å‡πâ Sheet
            const fullAddress = [
                document.getElementById('addr_street').value,
                document.getElementById('addr_subdistrict').value,
                document.getElementById('addr_district').value,
                document.getElementById('addr_province').value,
                document.getElementById('addr_zip').value
            ].filter(Boolean).join(' '); // ‡πÄ‡∏≠‡∏≤‡∏°‡∏≤‡∏ï‡πà‡∏≠‡∏Å‡∏±‡∏ô‡πÅ‡∏•‡πâ‡∏ß‡∏Ñ‡∏±‡πà‡∏ô‡∏î‡πâ‡∏ß‡∏¢‡∏ä‡πà‡∏≠‡∏á‡∏ß‡πà‡∏≤‡∏á

            const data = {
                company: document.getElementById('companyName').value,
                address: fullAddress, // ‡∏™‡πà‡∏á‡πÑ‡∏õ‡πÄ‡∏õ‡πá‡∏ô‡∏Å‡πâ‡∏≠‡∏ô‡πÄ‡∏î‡∏µ‡∏¢‡∏ß
                taxId: document.getElementById('taxId').value,
                phone: document.getElementById('phone').value,
                email: document.getElementById('email').value
            };

            btn.innerHTML = '‚è≥ ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å...';
            btn.disabled = true;
            btn.classList.add('opacity-50');

            fetch(GOOGLE_SCRIPT_URL, {
                method: 'POST',
                mode: 'no-cors', 
                headers: { 'Content-Type': 'text/plain' },
                body: JSON.stringify(data)
            })
            .then(() => {
                btn.innerHTML = '‚úÖ ‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢!';
                btn.classList.replace('bg-green-600', 'bg-indigo-600');
                status.innerText = '‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ñ‡∏π‡∏Å‡∏™‡πà‡∏á‡πÄ‡∏Ç‡πâ‡∏≤ Google Sheets ‡πÅ‡∏•‡πâ‡∏ß';
                status.className = 'text-center text-xs mt-2 h-4 font-semibold text-green-600';
                
                setTimeout(() => {
                    btn.innerHTML = 'üíæ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• (Save)';
                    btn.disabled = false;
                    btn.classList.remove('opacity-50');
                    btn.classList.replace('bg-indigo-600', 'bg-green-600');
                    status.innerText = '';
                }, 3000);
            })
            .catch(error => {
                console.error('Error:', error);
                btn.innerHTML = '‚ùå ‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î';
                status.innerText = '‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à';
                status.className = 'text-center text-xs mt-2 h-4 font-semibold text-red-500';
                btn.disabled = false;
            });
        }
    </script>
</body>
</html>
